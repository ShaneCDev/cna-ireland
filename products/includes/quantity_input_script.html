<script type="text/javascript">

    /*
    * Disable the plus and minus buttons outside the range of 1-99
    */
    function handleEnableDisable(itemId) {
        currentValue = parseInt(document.querySelector(`.id_qty_${itemId}`).value);

        var minusDisabled = currentValue < 2;
        var plusDisabled = currentValue > 98;

        if (minusDisabled || plusDisabled) {
            document.querySelector(`.decrement-qty_${itemId}`).disabled = minusDisabled;
            document.querySelector(`.decrement-qty_${itemId}`).disabled = plusDisabled;
        }

        // ensure proper enabling/disabling of all inputs on page load
        var allQtyInputs = document.querySelectorAll('.qty_input');
        for (var i = 0; i < allQtyInputs.length; i++) {
            var itemId = allQtyInputs[i].dataset.item_id;
            handleEnableDisable(itemId);
        }
    }

    // check enable/disable everytime the input is changed
    var qtyInputs = document.querySelectorAll('.qty_input');
    qtyInputs.forEach(function(input) {
        input.addEventListener('change', function() {
            var itemId = this.dataset.item_id;
            handleEnableDisable(itemId);
        });
    });

    // increment qty
    var incrementButtons = document.querySelectorAll('.increment-qty');
    incrementButtons.forEach(function (button) {
        button.addEventListener('click', function (e) {
            e.preventDefault();
            var itemId = this.dataset.item_id;
            var closestInput = this.closest('.input-group').querySelector('.qty_input');
            var allQuantityInputs = document.querySelectorAll(`.input-group-${itemId} input[name='quantity']`);
            var currentValue = parseInt(closestInput.value);
            allQuantityInputs.forEach(function(input) {
                input.value = currentValue + 1;
            });
            handleEnableDisable(itemId);
        });
    });

    // decrement qty
    var decrementButtons = document.querySelectorAll('.decrement-qty');
    decrementButtons.forEach(function (button) {
        button.addEventListener('click', function (e) {
            e.preventDefault();
            var itemId = this.dataset.item_id;
            var closestInput = this.closest('.input-group').querySelector('.qty_input');
            var allQuantityInputs = document.querySelectorAll(`.input-group-${itemId} input[name='quantity']`);
            var currentValue = parseInt(closestInput.value);
            allQuantityInputs.forEach(function (input) {
                input.value = currentValue - 1;
            });
        });
    });
</script>